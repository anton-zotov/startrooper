!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([function(t,e,n){t.exports=n.p+"492d1caae820dfb21da9e2a4a1d3e62a.png"},function(t,e,n){t.exports=n.p+"6423a2227deb59499efe6ee1d5615b7e.png"},function(t,e,n){t.exports=n.p+"bca84165263a9a2c30b2fe5ec0567441.png"},function(t,e,n){t.exports=n.p+"7475b2c68b4b74ce5572bcc1af402486.png"},function(t,e,n){t.exports=n.p+"b609481bbf68a8c2ec04c319f9075c8e.png"},function(t,e,n){var i=n(6);"string"==typeof i&&(i=[[t.i,i,""]]);var a={insert:"head",singleton:!1};n(8)(i,a);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(7)(!1)).push([t.i,"html, body {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n}",""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var a=(s=i,r=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(h," */")),o=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot).concat(t," */")}));return[n].concat(o).concat([a]).join("\n")}var s,r,h;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<t.length;s++){var r=t[s];null!=r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="(".concat(r[2],") and (").concat(n,")")),e.push(r))}},e}},function(t,e,n){"use strict";var i,a={},o=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},s=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}();function r(t,e){for(var n=[],i={},a=0;a<t.length;a++){var o=t[a],s=e.base?o[0]+e.base:o[0],r={css:o[1],media:o[2],sourceMap:o[3]};i[s]?i[s].parts.push(r):n.push(i[s]={id:s,parts:[r]})}return n}function h(t,e){for(var n=0;n<t.length;n++){var i=t[n],o=a[i.id],s=0;if(o){for(o.refs++;s<o.parts.length;s++)o.parts[s](i.parts[s]);for(;s<i.parts.length;s++)o.parts.push(g(i.parts[s],e))}else{for(var r=[];s<i.parts.length;s++)r.push(g(i.parts[s],e));a[i.id]={id:i.id,refs:1,parts:r}}}}function c(t){var e=document.createElement("style");if(void 0===t.attributes.nonce){var i=n.nc;i&&(t.attributes.nonce=i)}if(Object.keys(t.attributes).forEach((function(n){e.setAttribute(n,t.attributes[n])})),"function"==typeof t.insert)t.insert(e);else{var a=s(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var u,l=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function d(t,e,n,i){var a=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=l(e,a);else{var o=document.createTextNode(a),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function f(t,e,n){var i=n.css,a=n.media,o=n.sourceMap;if(a&&t.setAttribute("media",a),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var p=null,m=0;function g(t,e){var n,i,a;if(e.singleton){var o=m++;n=p||(p=c(e)),i=d.bind(null,n,o,!1),a=d.bind(null,n,o,!0)}else n=c(e),i=f.bind(null,n,e),a=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else a()}}t.exports=function(t,e){(e=e||{}).attributes="object"==typeof e.attributes?e.attributes:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o());var n=r(t,e);return h(n,e),function(t){for(var i=[],o=0;o<n.length;o++){var s=n[o],c=a[s.id];c&&(c.refs--,i.push(c))}t&&h(r(t,e),e);for(var u=0;u<i.length;u++){var l=i[u];if(0===l.refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete a[l.id]}}}}},function(t,e,n){"use strict";function i(t=0,e=0,n=0,i=.5,a=.5){let o=document.createElement("canvas"),s=o.getContext("2d");return o.width=1.5*t,o.height=1.5*e,s.translate(o.width*i,o.height*a),s.rotate(n),{canvas:o,ctx:s}}function a({canvas:t,ctx:e},n,i,a,o,s=.5,r=.5){e.setTransform(1,0,0,1,i,a),e.rotate(o),e.drawImage(n,-n.width*s,-n.height*r),e.setTransform(1,0,0,1,0,0)}function o(t,e,{x:n,y:i,color:a="white",fontSize:o=20}){Array.isArray(t)||(t=[t]),e.textAlign="center",e.fillStyle=a,e.font=`${o}px Open Sans`;for(let a of t)e.fillText(a,n,i),i+=o}function s(t,{x:e,y:n,r:i,color:a}){t.strokeStyle=a,t.beginPath(),t.arc(e,n,i,0,2*Math.PI),t.stroke()}n.r(e);const r=(t,e)=>Math.acos(-t/Math.sqrt(t**2+e**2)),h=(t,e,n)=>t>n?n:t<e?e:t;function c(t,e){let n=new Set,i={x:100,y:100};return t.onkeydown=t=>d(t.key,n),t.onkeyup=t=>f(t.key,n),t.onmousemove=t=>{i.x+=t.movementX,i.y+=t.movementY,i.x=h(i.x,0,e.width),i.y=h(i.y,0,e.height)},e.onmousedown=t=>d(l(t),n),e.onmouseup=t=>f(l(t),n),e.oncontextmenu=()=>!1,()=>({keysPressed:n,mouseMovement:i})}const u=Object.freeze({left:"lmb",right:"rmb",middle:"mmb"});function l(t){switch(t.button){case 0:return u.left;case 1:return u.middle;case 2:return u.right}}function d(t,e){e.add(t.toLowerCase())}function f(t,e){e.delete(t.toLowerCase())}function p(t,e){let n=0,i=0,a=!1,o=!1,s=this.x+(this.weaponX||0),h=this.y+(this.weaponY||0),c=r(s-e.x,h-e.y);return e.y<this.y&&(c=-c),t.has("w")&&(i=-1),t.has("s")&&(i=1),t.has("d")&&(n=1),t.has("a")&&(n=-1),t.has("lmb")&&(a=!0),t.has("rmb")&&(o=!0),{upward:i,forward:n,angle:c,fire:a,secondary:o}}const m=Symbol("dead"),g={agent:1,bullet:2};function v(t){this.hp=0,w(this,t)}function y(t){this.hp=Math.max(0,this.hp-t.damage),this.hp<=0&&w(this,t)}function w(t,e){e.owner&&!e.owner[m]&&(e.owner.score=(e.owner.score||0)+(t.worthPoints||100)),t.onDie?t.onDie():t[m]=!0}function x(t,e,n){let i=500*e*Math.cos(this.angle),a=500*e*Math.sin(this.angle);this.x+=i,this.y+=a,this.liveTimeLeft-=e,this.liveTimeLeft<=0&&(this[m]=!0),function(t,{gameObjects:e}){for(let n of e)n!==t&&n.interactsWithAmmo&&(t.team&&t.team===n.team||M(t,n)&&(t.onHit(n),n.onHit(t)))}(this,n)}function b({ctx:t}){!function({canvas:t,ctx:e}){e.clearRect(-t.width/2,-t.height/2,2*t.width,2*t.height)}(this.canvasBundle),this.canvasBundle.ctx.fillStyle="#00F0F0",this.canvasBundle.ctx.fillRect(-this.width/2,-this.height/2,this.width,this.height),t.drawImage(this.canvasBundle.canvas,this.x-15,this.y-15)}function M(t,e){let n=Math.min(t.width,t.height),i=Math.min(e.width,e.height);return(t.x-e.x)**2+(t.y-e.y)**2<=(n+i)**2}function S({cooldown:t}){t*=1e3;const e=Symbol("centered fire cooldown");return function(n,a){var o;(!this[e]||this[e]+t<n)&&(a.push({update:x,draw:b,onHit:v,x:(o=this).x+(o.weaponX||0),y:o.y+(o.weaponY||0),angle:o.angle,width:20,height:6,canvasBundle:i(20,20,o.angle),liveTimeLeft:3,team:o.team,owner:o,damage:25,type:g.bullet}),this[e]=n)}}var P=n(0),T=n.n(P),B=n(1),L=n.n(B),H=n(2),j=n.n(H),k=n(3),O=n.n(k),I=n(4),C=n.n(I);const R={playerShip:T.a,shield:j.a,artilleryBody:O.a,artilleryGun:C.a,enemy1:L.a};const A=1,W=25;function E({ctx:t}){this.host.shieldActive&&!this.isDepleted&&t.drawImage(R.shield,this.x+70-R.shield.width/2,this.y-R.shield.height/2)}function D(t,e){this.recoveryPause&&(this.recoveryPause=Math.max(0,this.recoveryPause-e)),!this.host.shieldActive||this.isDepleted?this.isRecovering?this.recoveryPause||(this.hp=Math.min(this.maxHp,this.hp+W*e),this.hp===this.maxHp&&(this.isDepleted=!1)):(this.isRecovering=!0,this.recoveryPause=A):this.recoveryPause=A,this.x=this.host.x+70,this.y=this.host.y,this.interactsWithAmmo=this.host.shieldActive}function N(){this.isDepleted=!0,this.isRecovering=!0,this.recoveryPause=A}function q(){let t={update:$,draw:F,getControls:p,fire:S({cooldown:.2}),onHit:y,x:100,y:100,vx:0,vy:0,angle:0,width:R.playerShip.width,height:R.playerShip.height,weaponX:25,canvasBundle:i(100,100),interactsWithAmmo:!0,team:1,maxHp:100,hp:100,shieldActive:!1,score:0},e=(n=t,{update:D,draw:E,onHit:y,onDie:N,x:100,y:100,width:R.shield.width,height:R.shield.height,canvasBundle:i(100,100),host:n,team:n.team,hp:100,maxHp:100,interactsWithAmmo:!0});var n;return t.shield=e,[t,e]}function $(t,e,n){let i=this.getControls(n.keysPressed,n.mouseMovement),a=400;i.forward&&i.upward&&(a*=Math.SQRT1_2);let o=i.forward*e*a;this.x+=o,this.x=h(this.x,this.width/2,n.canvasBundle.canvas.width-this.width/2);let s=i.upward*e*a;this.y+=s,this.y=h(this.y,this.height/2,n.canvasBundle.canvas.height-this.height/2),this.angle=i.angle,i.fire&&this.fire(t,n.gameObjects),this.shieldActive=i.secondary}function F({ctx:t}){t.drawImage(R.playerShip,this.x-R.playerShip.width/2,this.y-R.playerShip.height/2)}function _({ctx:t},e){void 0!==e&&o(`FPS: ${e}`,t,{x:50,y:20})}function z(t,{dt:e,player:n,wave:i}){_(t,e),function({ctx:t,canvas:e},n){o(`Health: ${Math.round(n.hp/n.maxHp*100)}%`,t,{x:70,y:e.height-30})}(t,n),function({ctx:t,canvas:e},n){o(`Shield: ${Math.round(n.shield.hp/n.shield.maxHp*100)}%`,t,{x:e.width-100,y:e.height-30})}(t,n),function({ctx:t,canvas:e},n){o(`Score: ${n.score||0}`,t,{x:e.width/2,y:e.height-55})}(t,n),function({ctx:t,canvas:e},n){o(`Wave: ${n}`,t,{x:e.width/2,y:e.height-30})}(t,i)}const U=t=>t[Math.floor(t.length*Math.random())],X=.001;let Y,G=!1,J=[],Q=[];function K(t){let e=U(Q),n=Math.random()*t.canvas.width,i=Math.random()*t.canvas.height,a=8*Math.random();return{draw:function(){t.ctx.drawImage(e.canvas,Math.floor(n),Math.floor(i))},update:function(){(n-=a)<30&&(n=t.canvas.width+30,e=U(Q))}}}function V({ctx:t},e){let n=.7*Math.random();t.beginPath();for(let n=0;n<5;n++)t.lineTo(0,e),t.translate(0,e),t.rotate(2*Math.PI/10),t.lineTo(0,-e),t.translate(0,-e),t.rotate(-6*Math.PI/10);t.lineTo(0,e),t.closePath(),t.fillStyle="rgb(255, 255, 200)",t.fillStyle=`rgba(255, 255, 200, ${n})`,t.fill()}function Z(t){G||function(t){for(let t=0;t<20;t++){let e=i(10,10);V(e,1+t%3),Q.push(e)}Y=Math.floor(t.canvas.width*t.canvas.height*X);for(let e=0;e<Y;e++)J.push(K(t));G=!0}(t),function({canvas:t,ctx:e},n="#000"){e.fillStyle=n,e.fillRect(-t.width/2,-t.height/2,2*t.width,2*t.height)}(t);for(let t of J)t.draw(),t.update()}function tt(t){let{width:e,height:n}=t.canvasBundle.canvas;return{update:et,draw:nt,fire:S({cooldown:1}),onHit:y,x:e+100,y:100,angle:Math.PI,width:50,height:50,canvasBundle:i(50,50),stepTime:3,stepTimeLeft:3,step:0,interactsWithAmmo:!0,team:2,hp:5,canvasWidth:e,canvasHeight:n,timeLived:0,type:g.agent}}function et(t,e,n){let i=-250*e;this.x+=i,this.y=.4*this.canvasHeight*(1.2+Math.sin(2*this.timeLived)),this.stepTimeLeft-=e,this.timeLived+=e,this.stepTimeLeft<=0&&(this.stepTimeLeft=this.stepTime,this.step=(this.step+1)%2),this.x<-100&&(this[m]=!0),this.fire(t,n.gameObjects)}function nt({ctx:t}){t.drawImage(R.enemy1,this.x-R.enemy1.width/2,this.y-R.enemy1.height/2)}let it,at=0;function ot(t){let e=at++%2?"bottom":"top",{width:n,height:a}=t.canvasBundle.canvas;return{update:st,draw:rt,fire:S({cooldown:1}),onHit:y,x:n+100,y:"bottom"===e?20:a-20,position:e,angle:Math.PI,width:23,height:39,canvasBundle:i(50,50),stepTime:3,stepTimeLeft:3,step:0,interactsWithAmmo:!0,team:2,hp:5,canvasWidth:n,canvasHeight:a,created:t.currentTime,type:g.agent}}function st(t,e,n){let i=-150*e;this.x+=i,this.x<-100&&(this[m]=!0),this.angle=function(t,{player:e}){let n=t.x-e.x,i=t.y-e.y,a=r(n,i);i>0&&(a=-a);return a}(this,n),this.weaponX=10*Math.cos(this.angle),this.weaponY=10*Math.sin(this.angle),this.fire(t,n.gameObjects)}function rt(t){a(t,R.artilleryBody,this.x,this.y,"top"===this.position?Math.PI/2:-Math.PI/2),a(t,R.artilleryGun,this.x,this.y,this.angle,.15,.5)}function ht(t,e){let n=0,i=!1,a=[],o=0;return{nextWave:function(){a.length||(i=!0,a=function(t){let e=Math.min(10,Math.floor(t/2)),n=Math.min(10,1+t/2),i=[3];for(;e>0||n>0;)e-- >0&&i.push(ot),n-- >0&&i.push(tt),i.push(1);return i}(++n))},getWaveNumber:()=>n,update:e=>{if(o)o=Math.max(0,o-e);else if(a.length){let e=a.shift();"number"==typeof e?o=e:t.gameObjects.push(e(t,{id:0}))}}}}function ct(t){let e=t.getContext("2d"),n=[];it={canvasBundle:{canvas:t,ctx:e},gameObjects:n,getInputs:c(window,t),scoreTimer:0},[it.player,it.shield]=q(),n.push(it.player,it.shield),it.spawner=ht(it)}function ut(t,e=t){if(!it.isRunning)return;it.currentTime=t;let n=0;e&&(n=(t-e)/1e3),function(t,e){let{keysPressed:n,mouseMovement:i}=it.getInputs();it.keysPressed=n,it.mouseMovement=i;let a=0;for(let n of it.gameObjects)n.update(t,e,it),n.type===g.agent&&2===n.team&&a++;it.spawner.update(e),it.gameObjects=it.gameObjects.filter(t=>!t[m]),a||it.spawner.nextWave();(function(t){it.dtHistory||(it.dtHistory=[]);it.dtHistory.push(t),it.dtHistory.length>10&&it.dtHistory.shift();let e=it.dtHistory.reduce((t,e)=>t+e,0)/it.dtHistory.length;it.fps=e?Math.round(1/e):0})(e),function(t){if(it.player[m])return;it.scoreTimer+=t,it.scoreTimer>=1&&(it.scoreTimer-=1,it.player.score+=10)}(e)}(t,n),lt(),requestAnimationFrame(e=>ut(e,t))}function lt(){Z(it.canvasBundle);for(let t of it.gameObjects)t.draw(it.canvasBundle);z(it.canvasBundle,{player:it.player,shield:it.shield,wave:it.spawner.getWaveNumber()}),_(it.canvasBundle,it.fps),function({ctx:t,canvas:e},n){if(!n)return;let{x:i,y:a}=n;s(t,{x:i,y:a,r:14,color:"white"}),s(t,{x:i,y:a,r:1,color:"white"})}(it.canvasBundle,it.mouseMovement),it.player[m]?function({ctx:t,canvas:e},n){o(["Game over",`You score: ${n}`],t,{x:e.width/2,y:.5*e.height-70,fontSize:40}),o("Click to play again",t,{x:e.width/2,y:.5*e.height+10})}(it.canvasBundle,it.player.score):it.isRunning||function({ctx:t,canvas:e}){o(["Click on the screen to resume the game","Use W, A, S, D to move,","left mouse button to shoot","right mouse button to activate shield"],t,{x:e.width/2,y:e.height/2-40})}(it.canvasBundle)}function dt(){it.isRunning=!1,lt()}function ft(){it.isRunning||(it.isRunning=!0,requestAnimationFrame(ut))}function pt(){it.player[m]&&(ct(it.canvasBundle.canvas),it.isRunning=!0)}n(5);let mt=document.getElementById("scene");mt.width=window.innerWidth-5,mt.height=window.innerHeight-5,async function(t){t.getContext("2d"),await function(){let t=[];for(let e in R){let n=new Image;n.src=R[e],t.push(new Promise(t=>n.onload=t)),R[e]=n}return Promise.all(t)}(),ct(t),lt(),function(t,e,n){function i(){document.pointerLockElement===t||document.mozPointerLockElement===t?e():n()}document.addEventListener("pointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1)}(t,ft,dt),t.addEventListener("click",()=>(function(t){t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock,t.requestPointerLock()})(t)),t.addEventListener("mousedown",pt)}(mt)}]);